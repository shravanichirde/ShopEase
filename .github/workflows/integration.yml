name: Continuous Integration

on:
  # if any push on main branch
  push:
    branches:["main"]
  # if any pull request on main branch
  pull_request:
    branches:["main"]

jobs:
  build:
    runs-on: ubuntu-latest
  strategy:
    matrix:
      # see what node versions are supported by our application
      node-version: [18.x,20.x,22.x]
    defaults:
      run:
        # asking to check the code in the backend folder
        working-directory: ./backend
    steps:
      # get the code from the repo
      - name : Checkout Code
        uses : actions/checkout@v3

      # install nodejs
      - name : Setup Node.js
        uses : actions/setup-node@v3
        with:
          node-version : '20'

      # install dependencies
      - name : Install dependencies
        run : npm install

      # generate prisma client
      - name : Prisma Client
        run : npx prisma generate

      #  check the build
      - name : build check
        run : npm run build 